<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Serum Preset Preview</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
  font-family: monospace;
  color: #00ff88;
}

#app {
  width: 100vw;
  height: 100vh;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

/* VIDEO */
#video {
  width: 90%;
  max-width: 1100px;
  border-radius: 10px;
  background: black;
}

/* MIDI KEYS */
#keys {
  display: flex;
  margin-top: 20px;
  gap: 6px;
}

.key {
  width: 70px;
  height: 80px;
  border: 1px solid #00ff88;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 8px;
  cursor: pointer;
  user-select: none;
  transition: background 0.1s, transform 0.05s;
}

.key:active {
  background: #00ff8833;
  transform: translateY(2px);
}

/* PRESET NAV */
#preset-nav {
  margin-top: 14px;
  display: flex;
  align-items: center;
  gap: 20px;
}

.nav-btn {
  cursor: pointer;
  font-size: 22px;
}

/* LOADER */
#loader {
  position: absolute;
  inset: 0;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
  flex-direction: column;
}

#loader.hidden {
  display: none;
}

#loader-text {
  letter-spacing: 2px;
  animation: flicker 1.6s infinite;
}

@keyframes flicker {
  0% { opacity: 0.2 }
  20% { opacity: 1 }
  40% { opacity: 0.4 }
  60% { opacity: 1 }
  80% { opacity: 0.6 }
  100% { opacity: 1 }
}
</style>
</head>

<body>
<div id="app">

  <!-- LOADER -->
  <div id="loader">
    <div id="loader-text">LOADING PRESETS…</div>
  </div>

  <!-- VIDEO -->
  <video id="video" muted playsinline preload="auto"></video>

  <!-- PRESET NAV -->
  <div id="preset-nav">
    <div class="nav-btn" id="prev">◀</div>
    <div id="preset-name">PRESET 01</div>
    <div class="nav-btn" id="next">▶</div>
  </div>

  <!-- KEYS -->
  <div id="keys">
    <div class="key" data-note="C">C</div>
    <div class="key" data-note="D">D</div>
    <div class="key" data-note="E">E</div>
    <div class="key" data-note="F">F</div>
    <div class="key" data-note="G">G</div>
    <div class="key" data-note="A">A</div>
    <div class="key" data-note="B">B</div>
  </div>

</div>

<script>
const presets = [
  { name: "PRESET 01", video: "preset01.mp4", audio: "preset01.mp3" },
  { name: "PRESET 02", video: "preset02.mp4", audio: "preset02.mp3" },
  { name: "PRESET 03", video: "preset03.mp4", audio: "preset03.mp3" }
];

let current = 0;
let ready = false;

const video = document.getElementById("video");
const audio = new Audio();
audio.preload = "auto";

const loader = document.getElementById("loader");
const presetName = document.getElementById("preset-name");

function loadPreset(index) {
  ready = false;
  loader.classList.remove("hidden");

  const p = presets[index];
  presetName.textContent = p.name;

  video.src = p.video;
  audio.src = p.audio;

  let audioReady = false;
  let videoReady = false;

  audio.oncanplay = () => {
    audioReady = true;
    checkReady();
  };

  video.onloadeddata = () => {
    videoReady = true;
    checkReady();
  };

  function checkReady() {
    if (audioReady && videoReady) {
      ready = true;
      loader.classList.add("hidden");
    }
  }
}


function playNote() {
  if (!ready) return;

  audio.currentTime = 0;
  audio.play().catch(()=>{});

  video.pause();
  video.currentTime = 0;
  video.play().catch(()=>{});
}

document.querySelectorAll(".key").forEach(k => {
  k.addEventListener("click", playNote);
});

document.getElementById("prev").onclick = () => {
  current = (current - 1 + presets.length) % presets.length;
  loadPreset(current);
};

document.getElementById("next").onclick = () => {
  current = (current + 1) % presets.length;
  loadPreset(current);
};

window.addEventListener("load", () => {
  loadPreset(current);
});
</script>
</body>
</html>


