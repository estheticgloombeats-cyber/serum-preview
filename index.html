<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PAL Serum Preset Preview</title>

<style>
body {
  margin: 0;
  padding: 40px;
  background: radial-gradient(circle at center, #0a0f1f, #02040a);
  font-family: monospace;
  color: #e6f0ff;
  display: flex;
  justify-content: center;
}

/* MAIN BLOCK */
.preview {
  width: 960px;
  position: relative;
  opacity: 0;
  transition: opacity 0.8s ease;
}

.preview.ready {
  opacity: 1;
}

/* LOADER */
.loader {
  position: absolute;
  inset: 0;
  background: rgba(0,0,20,0.95);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  letter-spacing: 4px;
  color: #7db3ff;
  z-index: 50;
  animation: pulse 1.2s infinite;
}

@keyframes pulse {
  0% { opacity: .3; }
  50% { opacity: 1; }
  100% { opacity: .3; }
}

/* VIDEO */
video {
  width: 100%;
  display: block;
  border-radius: 8px;
  background: #000;
  box-shadow: 0 0 25px rgba(120,160,255,0.25);
}

/* PRESET LABEL */
.label {
  position: absolute;
  bottom: 12px;
  left: 16px;
  background: rgba(0,0,0,0.6);
  padding: 6px 12px;
  font-size: 13px;
  letter-spacing: 2px;
  color: #ffffff;
  border: 1px solid #7db3ff;
}

/* NAV BUTTONS */
.nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,40,0.8);
  border: 1px solid #7db3ff;
  color: #ffffff;
  padding: 12px 18px;
  font-size: 18px;
  cursor: pointer;
  user-select: none;
  transition: all 0.2s ease;
}

.nav:hover {
  background: rgba(30,60,120,0.9);
  box-shadow: 0 0 12px rgba(120,160,255,0.7);
}

.prev { left: 10px; }
.next { right: 10px; }

/* VOLUME */
.volume {
  margin-top: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 12px;
  color: #bcd7ff;
}

.volume input[type=range] {
  width: 160px;
}

/* DISCLAIMER */
.disclaimer {
  margin-top: 8px;
  font-size: 11px;
  color: #9bb7ff;
  opacity: 0.7;
  text-align: center;
}

/* KEYBOARD */
.keyboard {
  position: relative;
  height: 130px;
  margin-top: 16px;
  user-select: none;
}

/* WHITE KEYS */
.key.white {
  float: left;
  width: calc(100% / 8);
  height: 130px;
  background: linear-gradient(#f0f6ff, #c9d9ff);
  border: 1px solid #7db3ff;
  box-sizing: border-box;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  padding-bottom: 8px;
  font-size: 12px;
  color: #001133;
}

/* BLACK KEYS */
.key.black {
  position: absolute;
  top: 0;
  width: 34px;
  height: 80px;
  background: linear-gradient(#050b18, #0a1225);
  border: 1px solid #7db3ff;
  z-index: 5;
  cursor: pointer;
}

/* BLACK KEYS POSITION */
.b1 { left: 10%; }
.b2 { left: 22.5%; }
.b3 { left: 47.5%; }
.b4 { left: 60%; }
.b5 { left: 72.5%; }

.key:active {
  background: #7db3ff !important;
  color: #000;
  box-shadow: 0 0 16px #7db3ff;
}
</style>
</head>

<body>

<div class="preview" id="preview">

  <div class="loader" id="loader">
    LOADING PAL PRESETS…
  </div>

  <video id="video" loop muted playsinline></video>

  <div class="nav prev" onclick="prevPreset()">◄</div>
  <div class="nav next" onclick="nextPreset()">►</div>

  <div class="label" id="presetLabel">PRESET</div>

  <div class="keyboard">
    <div class="key white" onclick="playNote(0)">C</div>
    <div class="key white" onclick="playNote(2)">D</div>
    <div class="key white" onclick="playNote(4)">E</div>
    <div class="key white" onclick="playNote(5)">F</div>
    <div class="key white" onclick="playNote(7)">G</div>
    <div class="key white" onclick="playNote(9)">A</div>
    <div class="key white" onclick="playNote(11)">B</div>
    <div class="key white" onclick="playNote(12)">C</div>

    <div class="key black b1" onclick="playNote(1)"></div>
    <div class="key black b2" onclick="playNote(3)"></div>
    <div class="key black b3" onclick="playNote(6)"></div>
    <div class="key black b4" onclick="playNote(8)"></div>
    <div class="key black b5" onclick="playNote(10)"></div>
  </div>

  <div class="volume">
    VOLUME
    <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="0.7">
  </div>

  <div class="disclaimer">
    Presets are for preview purposes only and may not represent the final product quality.
  </div>

</div>

<script>
const presets = [
  { name: "PAL 01", video: "preset01.mp4", audio: "preset01.mp3" },
  { name: "PAL 02", video: "preset02.mp4", audio: "preset02.mp3" },
  { name: "PAL 03", video: "preset03.mp4", audio: "preset03.mp3" },
  { name: "PAL 04", video: "preset04.mp4", audio: "preset04.mp3" },
  { name: "PAL 05", video: "preset05.mp4", audio: "preset05.mp3" },
  { name: "PAL 06", video: "preset06.mp4", audio: "preset06.mp3" },
  { name: "PAL 07", video: "preset07.mp4", audio: "preset07.mp3" },
  { name: "PAL 08", video: "preset08.mp4", audio: "preset08.mp3" },
  { name: "PAL 09", video: "preset09.mp4", audio: "preset09.mp3" },
  { name: "PAL 10", video: "preset10.mp4", audio: "preset10.mp3" },
  { name: "PAL 11", video: "preset11.mp4", audio: "preset11.mp3" },
  { name: "PAL 12", video: "preset12.mp4", audio: "preset12.mp3" },
  { name: "PAL 13", video: "preset13.mp4", audio: "preset13.mp3" },
  { name: "PAL 14", video: "preset14.mp4", audio: "preset14.mp3" },
  { name: "PAL 15", video: "preset15.mp4", audio: "preset15.mp3" },
  { name: "PAL 16", video: "preset16.mp4", audio: "preset16.mp3" },
  { name: "PAL 17", video: "preset17.mp4", audio: "preset17.mp3" },
  { name: "PAL 18", video: "preset18.mp4", audio: "preset18.mp3" }
];

let index = 0;
const video = document.getElementById("video");
const label = document.getElementById("presetLabel");
const volumeControl = document.getElementById("volumeControl");

let audioCtx;
let source;
let gainNode;
const bufferCache = {};

function initAudio() {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    gainNode = audioCtx.createGain();
    gainNode.connect(audioCtx.destination);
    gainNode.gain.value = volumeControl.value;
  }
}

volumeControl.addEventListener("input", () => {
  if (gainNode) gainNode.gain.value = volumeControl.value;
});

function loadPreset(i) {
  index = (i + presets.length) % presets.length;
  video.pause();
  video.src = presets[index].video;
  label.textContent = `PRESET ${index + 1} — ${presets[index].name}`;
}

function nextPreset() { loadPreset(index + 1); }
function prevPreset() { loadPreset(index - 1); }

async function playNote(semitones) {
  initAudio();

  if (source) source.stop();

  if (!bufferCache[index]) {
    const res = await fetch(presets[index].audio);
    const arr = await res.arrayBuffer();
    bufferCache[index] = await audioCtx.decodeAudioData(arr);
  }

  source = audioCtx.createBufferSource();
  source.buffer = bufferCache[index];
  source.playbackRate.value = Math.pow(2, semitones / 12);
  source.connect(gainNode);
  source.start();

  video.currentTime = 0;
  video.play().catch(() => {});
  setTimeout(() => video.pause(), 1600);
}

/* INIT */
loadPreset(0);

/* LOADER TIMER */
const preview = document.getElementById("preview");
const loader = document.getElementById("loader");

setTimeout(() => {
  loader.remove();
  preview.classList.add("ready");
}, 2200);
</script>

</body>
</html>
